rootclass='user'; [ $(id -u) == '0' ] && rootclass='root'
export TEXTDOMAIN='tazpanel'

cat << EOT
<!DOCTYPE html>
<html lang="${LANG%%_*}">
<head>
	<title>$TITLE</title>
	<link rel="shortcut icon" href="/styles/$STYLE/favicon.ico"/>
	<meta name="viewport" content="width=device-width,initial-scale=1"/>
$(printf '\t<link rel="stylesheet" type="text/css" href="/%s"/>\n' $(cd /var/www/tazpanel; ls styles/$STYLE/*.css))
$(printf '\t<script type="text/javascript" src="/%s"></script>\n' $(cd /var/www/tazpanel; ls lib/*.js))
</head>
<body class="$rootclass">
<script type="text/javascript">setColorTheme(); setBaseFont();</script>

<header>
	<h1 data-icon="tazpanel">$TITLEÂ </h1>
</header>

<nav id="toolbar">
 <menu type="toolbar" id="toolbarMenu">
  <li tabindex="1">
   <span>$(_ 'Panel')</span>
   <menu>
    <li><a data-icon="info"     href="index.cgi">$(_ 'Summary')</a></li>
    <li><a data-icon="proc"     href="index.cgi?top">$(_ 'Processes')</a></li>
    <li><a data-icon="terminal" href="index.cgi?cmd=help">$(_ 'Terminal')</a></li>
    <li><a data-icon="report"   href="index.cgi?report" data-root>$(_ 'Create Report')</a></li>
    $(for i in menu.d/panel/* ; do [ -f $i ] && sh $i menu $i ; done)
   </menu>
  </li>
  <li tabindex="2">
   <span>$(_ 'Network')</span>
   <menu>
    <li><a data-icon="info" href="network.cgi">$(_ 'Summary')</a></li>
    <li><a data-icon="conf" href="index.cgi?file=/etc/network.conf">$(_ 'Config file')</a></li>
    <li><a data-icon="eth"  href="network.cgi?eth">$(_ 'Ethernet')</a></li>
    <li><a data-icon="wifi" href="network.cgi?wifi">$(_ 'Wireless')</a></li>
    $(for i in menu.d/network/* ; do [ -f $i ] && sh $i menu $i ; done)
   </menu>
  </li>
  <li tabindex="3">
   <span>$(_ 'Boot')</span>
   <menu>
    <li><a data-icon="info" href="boot.cgi">$(_ 'Summary')</a></li>
EOT
		[ -w /boot/grub/menu.lst ] && cat <<EOT
    <li><a data-icon="grub" href="boot.cgi?grub">$(_ 'Boot loader')</a></li>
EOT
cat << EOT
    <li><a data-icon="logs" href="boot.cgi?log">$(_ 'Boot logs')</a>
     <menu>
      <li><a data-icon="" href="boot.cgi?log=kernel">$(_ 'Kernel messages')</a></li>
      <li><a data-icon="" href="boot.cgi?log=boot">$(_ 'Boot scripts')</a></li>
      <li><a data-icon="" href="boot.cgi?log=xlog">$(_ 'X server')</a></li>
      <li><a data-icon="" href="boot.cgi?log=slim">$(_ 'X session')</a></li>
     </menu>
    </li>
    <li><a data-icon="logs" href="boot.cgi?syslog">$(_ 'System logs')</a>
    <li><a data-icon="daemons" href="boot.cgi?daemons" data-root>$(_ 'Manage daemons')</a></li>
    $([ "$REMOTE_USER" == "root" -a -x /usr/bin/taziso ] &&
	echo "<li><a data-icon=\"cd\" href=\"boot.cgi?iso\">$(_ 'ISO mine')</a>")
    $(for i in menu.d/boot/* ; do [ -f $i ] && sh $i menu $i ; done)
   </menu>
  </li>
  <li tabindex="4">
   <span>$(_ 'Hardware')</span>
   <menu>
    <li><a data-icon="info"    href="hardware.cgi">$(_ 'Summary')</a></li>
    <li><a data-icon="modules" href="hardware.cgi?modules">$(_ 'Kernel modules')</a></li>
    <li><a data-icon="detect"  href="hardware.cgi?detect" data-root>$(_ 'Detect PCI/USB')</a></li>
    <li><a data-icon="hdd"     href="hardware.cgi#disk">$(_ 'Disks')</a></li>
    $(for i in menu.d/hardware/* ; do [ -f $i ] && sh $i menu $i ; done)
   </menu>
  </li>
  <li tabindex="5">
   <span>$(_ 'Settings')</span>
   <menu>
    <li><a data-icon="info"  href="settings.cgi" data-root>$(_ 'Summary')</a></li>
    <li><a data-icon="user"  href="settings.cgi?users" data-root>$(_ 'Users')</a></li>
    <li><a data-icon="group" href="settings.cgi?groups" data-root>$(_ 'Groups')</a></li>
    $(for i in menu.d/settings/* ; do [ -f $i ] && sh $i menu $i ; done)
   </menu>
  </li>
EOT
cat << EOT
  $(for i in menu.d/* ; do [ -f $i ] && sh $i menu $i ; done)
 </menu>
 <span id="icons">
EOT

username="${REMOTE_USER:-root}"
case "$username" in
	root) icon='slitaz'; warn=''
	      toggle_url="http://$HTTP_HOST/";;
	*)    icon='user';   warn="$(_ 'Some features are disabled.')"$'\n'
	      toggle_url="http://$RANDOM:*@$HTTP_HOST/user/";;
esac

	cat << EOT
  <a data-img="$icon" title="$(_ 'You are logged in to the TazPanel as user %s.' $username)
$warn$(_ 'Click to re-login.')" href="$toggle_url$(basename $REQUEST_URI)"></a>
  <a data-img="help" href="help.cgi"></a>
 </span>
</nav>
<div id="noMenu"></div>
<script type="text/javascript">addMenuHandlers();</script>

<!-- Page content -->
<div id="content">
EOT
